import{i as T,d as f,a as v,b,c as O,e as q,u as _,j as l,f as E}from"./client-Bfrj2aVM.js";function R(e){return e instanceof Headers?new Headers(e):Array.isArray(e)?new Headers(e):typeof e=="object"?new Headers(e):new Headers}function $(...e){return e.reduce((n,t)=>{const r=R(t);for(const[a,s]of r.entries())n.set(a,s);return n},new Headers)}const N=[];function m(e,n){const t=n||e||{};return typeof t.method>"u"&&(t.method="GET"),{options:t,middleware:r=>m(void 0,Object.assign(t,{middleware:r})),validator:r=>m(void 0,Object.assign(t,{validator:r})),handler:(...r)=>{const[a,s]=r;Object.assign(t,{...a,extractedFn:a,serverFn:s}),T(a.url);const i=[...t.middleware||[],C(t)];return Object.assign(async c=>j(i,"client",{...a,method:t.method,data:c?.data,headers:c?.headers,context:{}}).then(o=>{if(o.error)throw o.error;return o.result}),{...a,__executeServer:async c=>{const o=c instanceof FormData?H(c):c;return await j(i,"server",{...a,...o}).then(d=>({result:d.result,error:d.error,context:d.sendContext}))}})}}}function H(e){const n=e.get("__TSR_CONTEXT");if(e.delete("__TSR_CONTEXT"),typeof n!="string")return{context:{},data:e};try{return{context:f.parse(n),data:e}}catch{return{data:e}}}function S(e){const n=new Set,t=[],r=a=>{a.forEach(s=>{s.options.middleware&&r(s.options.middleware),n.has(s)||(n.add(s),t.push(s))})};return r(e),t}const x=async(e,n,t)=>e({...n,next:async(r={})=>t({...n,...r,context:{...n.context,...r.context},sendContext:{...n.sendContext,...r.sendContext??{}},headers:$(n.headers,r.headers),result:r.result!==void 0?r.result:n.result,error:r.error??n.error})});function M(e,n){if(e==null)return{};if("~standard"in e){const t=e["~standard"].validate(n);if(t instanceof Promise)throw new Error("Async validation not supported");if(t.issues)throw new Error(JSON.stringify(t.issues,void 0,2));return t.value}if("parse"in e)return e.parse(n);if(typeof e=="function")return e(n);throw new Error("Invalid validator type!")}async function j(e,n,t){const r=S([...N,...e]),a=async s=>{const i=r.shift();if(!i)return s;i.options.validator&&(n!=="client"||i.options.validateClient)&&(s.data=await M(i.options.validator,s.data));const c=n==="client"?i.options.client:i.options.server;return c?x(c,s,async o=>{const h=i.options.clientAfter;if(n==="client"&&h){const d=await a(o);return x(h,{...o,...d},w=>w)}return a(o).catch(d=>{if(v(d)||b(d))return{...o,error:d};throw d})}):a(s)};return a({...t,headers:t.headers||{},sendContext:t.sendContext||{},context:t.context||{}})}function C(e){return{_types:void 0,options:{validator:e.validator,validateClient:e.validateClient,client:async({next:n,sendContext:t,...r})=>{var a;const s=await((a=e.extractedFn)==null?void 0:a.call(e,{...r,context:t}));return n(s)},server:async({next:n,...t})=>{var r;const a=await((r=e.serverFn)==null?void 0:r.call(e,t));return n({...t,result:a})}}}}async function I(e,n,t){var r;const a=n[0];if(O(a)&&a.method){const o=a,h=o.data instanceof FormData?"formData":"payload",d=new Headers({...h==="payload"?{"content-type":"application/json",accept:"application/json"}:{},...o.headers instanceof Headers?Object.fromEntries(o.headers.entries()):o.headers||{}});if(o.method==="GET"){const u=q({payload:f.stringify({data:o.data,context:o.context})});u&&(e+=`&${u}`)}const w=new Request(e,{method:o.method,headers:d,...P(o)}),F=await t(w),p=await g(F);if((r=p.headers.get("content-type"))!=null&&r.includes("application/json")){const u=f.decode(await p.json());if(v(u)||b(u)||u instanceof Error)throw u;return u}return p}const s=new Request(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)}),i=await g(await t(s)),c=i.headers.get("content-type");return c&&c.includes("application/json")?f.decode(await i.json()):i.text()}function P(e){return e.method==="POST"?e.data instanceof FormData?(e.data.set("__TSR_CONTEXT",f.stringify(e.context)),{body:e.data}):{body:f.stringify({data:e.data??null,context:e.context})}:{}}async function g(e){if(!e.ok){const n=e.headers.get("content-type");throw n&&n.includes("application/json")?f.decode(await e.json()):new Error(await e.text())}return e}function A(e){return e.replace(/^\/|\/$/g,"")}function k(e,n,t){return`${e}/${A("/_server")}/?_serverFnId=${encodeURI(n)}&_serverFnName=${encodeURI(t)}`}function D(e,n,t){const r=k(window.location.origin,n,t);return Object.assign((...s)=>I(r,s,fetch),{url:r,filename:n,functionId:t})}const J=e=>(e-273.15)*9/5+32,y=e=>J(e).toPrecision(4),B=()=>{const e=_({from:"/query/$query",select:n=>n.daily});return l.jsx("div",{className:"flex flex-col gap-5 bg-white shadow-md p-2 rounded w-10/12",children:e.slice(0,7).map(n=>l.jsxs("div",{className:"flex flex-col justify-around items-center border-1 bg-slate-200 border-black rounded-lg w-32",children:[l.jsxs("h3",{children:["Min: ",y(n.temp.min)]}),l.jsxs("h3",{children:["Max: ",y(n.temp.max)]})]}))})},U=()=>{const e=_({from:"/query/$query",select:n=>n.hourly});return l.jsx("div",{className:"flex justify-evenly gap-5 bg-white shadow-md p-2 rounded w-10/12 h-40",children:e.slice(0,3).map(n=>l.jsxs("div",{className:"flex flex-col justify-around items-center border-1 bg-slate-200 border-black rounded-lg w-32",children:[l.jsx("h3",{children:y(n.temp)}),l.jsxs("h3",{children:[y(n.dew_point),"%"]})]}))})},X=m().handler(D(z,"c_l9nrw0","$$function0")),L=function(){const{query:n}=E({from:"/query/$query"});return l.jsxs("div",{className:"flex flex-col items-center gap-10 bg-blue-300 h-full",children:[l.jsx("h1",{children:n}),l.jsx(U,{}),l.jsx(B,{})]})},V=async({params:e})=>await X({data:{query:e.query}});function z(e){}export{z as $$function0,L as component,V as loader};
